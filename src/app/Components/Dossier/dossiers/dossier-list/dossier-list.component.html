<div class="split">
    <div class=" top">
        <h1 class="titlle ">Dossiers List</h1>
        <button class="bt" kendoButton (click)="open('dossier')" style="margin-left:90%">Add new dossier</button>
    </div>
    <div class="bottom">
        <kendo-grid [kendoGridBinding]="gridData" filterable="menu" style=" background: rgb(45, 43, 43); border: none;"
            [height]="700">
            <kendo-grid-column field="dossierNumber" title="Dossier Number" [width]="220">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <a routerLink="./Details/{{dataItem.id}}" [ngClass]="dataItem.active == true ? 'primary':'grey'">
                        {{ dataItem.dossierNumber}}</a>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="createdDate" title="Created Date">
                <ng-template kendoGridCellTemplate let-dataItem>
                   <span  [ngClass]="dataItem.active == true ? 'date':'grey'" > {{ dataItem.createdDate | date: 'MM/dd/yyyy' }}</span>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="createdBy." title="CreatedBy">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <kendo-avatar fillMode="outline" [ngClass]="dataItem.active == true ?'avatar':'avatarComp'" *ngIf="dataItem.createdBy?.userName != null ">
                        <span style="font-size:9px;">{{ dataItem.createdBy?.firstName[0] }}{{
                            dataItem.createdBy?.lastName[0] }}</span>
                    </kendo-avatar> {{ dataItem.createdBy?.userName }}
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="tasks" title="Progress">
                <ng-template kendoGridCellTemplate let-dataItem style="background: rgb(45, 43, 43); border: none;">
                    <div class="project-progress pull-left">
                        <span class="task-title" style="width: auto;">Have created:
                            <span class="percentage">{{dataItem.progress | number}}%</span>
                        </span>
                    </div>
                    <br>
                    <div class="progress">
                        <div [ngClass]="dataItem.active == true ?'analytics-line':'analytics-lineComp'" role="progressbar" aria-valuemin="0" aria-valuemax="100"
                            [style.width.%]="dataItem.progress"></div>
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column field="dossierStatus.longName" title="Dossier Status">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <div *ngIf="dataItem.active == true" 
                    style="display: flex; justify-content: space-between;">
                            <span  [ngClass]="dataItem?.dossierStatus?.longName=='InPreparation' ? 'primary':dataItem?.dossierStatus?.longName=='Completed'?'done2':'inprog'" style="flex-basis: 99%; flex-grow: 1;">
                             {{dataItem?.dossierStatus?.longName}}
                         </span>
                          <span kendoTooltip title="Deactivate dossier"> 
                                  <button kendoButton (click)="activateDossier( dataItem)" [fillMode]="fillMode" class="date " *ngIf="dataItem?.dossierStatus?.longName=='Completed'" > <span class="k-icon k-i-non-recurrence"></span>
                                  </button>
                           </span> 
                          
                    </div>
                    <div *ngIf="dataItem.active == false" style="display: flex; justify-content: space-between;">
                          <span style="flex-basis: 99%; flex-grow: 1;" class="inactive" >Inactive</span>
                        <span kendoTooltip title="Activate dossier">
                               <button kendoButton (click)="activateDossier( dataItem)" [fillMode]="fillMode" class="date" > <span class="k-icon k-i-reset"></span></button> </span> 
                    </div>
                </ng-template>
            </kendo-grid-column>
            <kendo-grid-column title=" " filter="date" [width]="150">
                <ng-template kendoGridCellTemplate let-dataItem>
                    <button kendoButton (click)="onButtonClick( dataItem.id)" [fillMode]="fillMode" class="date" >View Details <span
                            class="k-icon k-i-hyperlink-open-sm"></span></button>
                </ng-template>
            </kendo-grid-column>
        </kendo-grid>
    </div>
    <kendo-dialog title="Add Dossier" [animation]="animation" *ngIf="opened" (close)="close('cancel')" [minWidth]="250"
        [themeColor]="'dark'" style="background-color:rgba(0,0,0,0.2)" [width]="490">
        <!-- <form [formGroup]="dossierForm" >
            <div class="form-group">
                <label for="DossierNumber">Title:</label>
                <input type="text" class="form-control" id="DossierNumber" formControlName="DossierNumber" placeholder="Dossier Number">
                <div *ngIf="dossierForm.controls['DossierNumber'].invalid && (dossierForm.controls['DossierNumber'].dirty || dossierForm.controls['DossierNumber'].touched)"
                    class="alert alert-danger">
                    <div *ngIf="dossierForm.hasError('required','DossierNumber')">Title is required.</div>
                </div>
            </div>
            <div class="form-group form-check">
                <input type="checkbox" class="form-check-input" id="Assigned" formControlName="Assigned">
                <label class="form-check-label" for="Assigned"> Would you like to assign all tasks to yourself?</label>
            </div>
            <kendo-dialog-actions style="border:none;margin-top: 20px;">
                <button kendoButton (click)="close('no')">Cancel</button>
                <button kendoButton (click)="addDossier()" class="bt" [disabled]="dossierForm.invalid">
                    Add dossier
                </button>
            </kendo-dialog-actions>
        </form>-->
        <app-add-dossier></app-add-dossier>
    </kendo-dialog>
    <kendo-dialog title="Update dossier status" *ngIf="openedStatus" (close)="close('cancel')" [themeColor]="'dark'"
        [minWidth]="250" [width]="450">
        <form [formGroup]="StatusForm">
            <div class="form-group">
                <label for="dossier">Location:</label>
                <select class="form-control" id="dossierStatus" formControlName="dossierStatus">
                    <option *ngFor="let  item of Status" [value]=" item.id">{{ item.longName }}
                    </option>
                </select>
            </div>
            <kendo-dialog-actions style="border:none;margin-top: 20px;">
                <button kendoButton (click)="close('no')">Cancel</button>
                <button kendoButton (click)="updateStatus()" style="background-color: #3899DD;color: #fff;"
                    [disabled]="StatusForm.invalid">
                    Update
                </button>
            </kendo-dialog-actions>
        </form>

    </kendo-dialog>
    <kendo-dialog
title="Please confirm"
*ngIf="activateDos"
(close)="close('cancel')"
[minWidth]="250"
[width]="450"
[themeColor]="'dark'"
class="dialog"
>
<p style="margin: 30px; text-align: center;">
  Are you sure you want to {{SelectedDossier.active == true ? 'Activate' :'Deactivate'}} a dossier?
</p>
<kendo-dialog-actions>
  <button kendoButton (click)="close('cancel')">No</button>
  <button kendoButton (click)="Activate()" class="bt">
    Yes
  </button>
</kendo-dialog-actions>
</kendo-dialog>
